<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recruiter Assessment Tool</title>
    <style>
        /* Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            line-height: 1.6;
            color: #333;
            background-color: #f0f8ff; /* Light blue background */
            background-image: linear-gradient(135deg, #f0f8ff 0%, #e6f7ff 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Card Styles */
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 30px;
            border-top: 5px solid #4299e1; /* Blue accent top border */
        }

        .card-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .card-header:after {
            content: '';
            display: block;
            width: 60px;
            height: 4px;
            background-color: #ffd700; /* Yellow accent */
            margin: 15px auto 0;
            border-radius: 2px;
        }

        .card-title {
            font-size: 2.2rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .card-description {
            font-size: 1.1rem;
            color: #718096;
        }

        .card-content {
            margin-bottom: 20px;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        /* Tab Styles */
        .tabs {
            display: flex;
            justify-content: center;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: #718096;
            position: relative;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            color: #4299e1;
        }

        .tab-btn.active {
            color: #4299e1;
            font-weight: 600;
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #ffd700; /* Yellow indicator */
            border-radius: 3px 3px 0 0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #4a5568;
        }

        .required {
            color: #e53e3e;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
        }

        /* Skill Cards - Single Column Centered */
        .skill-cards {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .skill-card {
            width: 100%;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            background-color: #f8fafc;
            transition: all 0.3s ease;
        }

        .skill-card:hover {
            border-color: #4299e1;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.15);
        }

        .skill-card h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: #2d3748;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }

        .radio-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        @media (min-width: 500px) {
            .radio-group {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 6px;
            transition: background-color 0.2s;
        }

        .radio-option:hover {
            background-color: #edf2f7;
        }

        .radio-option input[type="radio"] {
            margin-right: 8px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        /* Level Colors */
        .beginner {
            color: #718096;
        }

        .intermediate {
            color: #4299e1;
        }

        .advanced {
            color: #48bb78;
        }

        .expert {
            color: #805ad5;
        }

        /* Industry Cards */
        .industry-cards {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 600px;
            margin: 0 auto;
        }

        .industry-card {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            background-color: #f8fafc;
            transition: all 0.3s ease;
        }

        .industry-card:hover {
            border-color: #4299e1;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.15);
        }

        .industry-card input[type="checkbox"] {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* Education and Experience Cards */
        .education-cards, .experience-cards {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 600px;
            margin: 0 auto;
        }

        .education-card, .experience-card {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            background-color: #f8fafc;
            transition: all 0.3s ease;
        }

        .education-card:hover, .experience-card:hover {
            border-color: #4299e1;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.15);
        }

        .education-card input[type="radio"], .experience-card input[type="radio"] {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* Buttons */
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: #4299e1; /* Blue */
            color: white;
            box-shadow: 0 4px 6px rgba(66, 153, 225, 0.2);
        }

        .btn-primary:hover {
            background-color: #3182ce;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(66, 153, 225, 0.3);
        }

        .btn-outline {
            background-color: transparent;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }

        .btn-outline:hover {
            background-color: #f7fafc;
            border-color: #cbd5e0;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* Results Section */
        .result-card {
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            background-color: #f8fafc;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            border-color: #4299e1;
            box-shadow: 0 6px 15px rgba(66, 153, 225, 0.15);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .result-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d3748;
        }

        .match-percentage {
            font-size: 1.2rem;
            font-weight: 700;
            color: #4299e1;
            background-color: rgba(66, 153, 225, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
        }

        .bonus-points {
            font-size: 0.9rem;
            color: #4299e1;
            margin-top: 5px;
            text-align: right;
        }

        .role-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .role-description {
            color: #718096;
            margin-bottom: 20px;
            line-height: 1.7;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 20px;
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        @media (min-width: 640px) {
            .skills-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .skills-section h4 {
            font-size: 1.1rem;
            margin-bottom: 12px;
            color: #4299e1;
            padding-bottom: 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        .skills-list {
            list-style-type: disc;
            padding-left: 25px;
        }

        .skills-list li {
            font-size: 0.95rem;
            margin-bottom: 6px;
        }

        /* Section Headers */
        .section-header {
            margin-bottom: 20px;
            text-align: center;
        }

        .section-header h2 {
            font-size: 1.5rem;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .section-header p {
            color: #718096;
            font-size: 0.95rem;
        }

        /* Utility Classes */
        .text-center {
            text-align: center;
        }

        .space-y-6 > * + * {
            margin-top: 1.5rem;
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        /* Spinner */
        .spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(66, 153, 225, 0.2);
            border-radius: 50%;
            border-top-color: #4299e1;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Yellow Accents */
        .yellow-accent {
            color: #ffd700;
        }

        .highlight {
            background-color: rgba(255, 215, 0, 0.15);
            padding: 2px 5px;
            border-radius: 4px;
        }
        
        /* Error message */
        .error-message {
            color: #e53e3e;
            font-size: 0.9rem;
            margin-top: 10px;
            padding: 8px 12px;
            background-color: rgba(229, 62, 62, 0.1);
            border-radius: 6px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Home Card -->
        <div class="card" id="homeCard">
            <div class="card-header">
                <h1 class="card-title">Recruiter Assessment Tool</h1>
                <p class="card-description">Complete the assessment to find the best role matches for your candidates</p>
            </div>
            <div class="card-content">
                <p style="margin-bottom: 30px; color: #718096; text-align: center; max-width: 600px; margin-left: auto; margin-right: auto;">
                    This tool helps recruiters identify the most suitable roles for candidates based on their skills,
                    technical knowledge, industry experience, education, and years of experience. The assessment will analyze your input and suggest the top 3
                    best-matching roles.
                </p>
                <div class="text-center">
                    <button class="btn-primary" id="startAssessmentBtn">Start Assessment</button>
                </div>
            </div>
        </div>

        <!-- Assessment Form Card -->
        <div class="card hidden" id="assessmentCard">
            <div class="card-header">
                <h1 class="card-title">Candidate Assessment</h1>
                <p class="card-description">Complete all sections to get role recommendations</p>
            </div>
            <div class="card-content">
                <form id="assessmentForm">
                    <!-- Applicant Tab -->
                    <div class="tabs">
                        <button type="button" class="tab-btn active" data-tab="applicant">Applicant</button>
                        <button type="button" class="tab-btn" data-tab="education">Education</button>
                        <button type="button" class="tab-btn" data-tab="skills">Skills</button>
                        <button type="button" class="tab-btn" data-tab="technical">Technical</button>
                        <button type="button" class="tab-btn" data-tab="industry">Industry</button>
                        <button type="button" class="tab-btn" data-tab="experience">Experience</button>
                    </div>

                    <!-- Applicant Tab Content -->
                    <div class="tab-content active" id="applicant">
                        <div class="section-header">
                            <h2>Applicant Information</h2>
                            <p>Enter the applicant's basic information</p>
                        </div>
                        <div class="space-y-6">
                            <div class="form-group">
                                <label for="name">Full Name <span class="required">*</span></label>
                                <input type="text" id="name" name="name" required placeholder="Enter applicant's full name">
                            </div>

                            <div class="form-group">
                                <label for="email">Email Address <span class="required">*</span></label>
                                <input type="email" id="email" name="email" required placeholder="Enter applicant's email address">
                            </div>

                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" name="phone" placeholder="Enter applicant's phone number (optional)">
                            </div>
                        </div>
                        <div class="error-message" id="applicantError">Please fill in all required fields.</div>
                    </div>

                    <!-- Education Tab Content -->
                    <div class="tab-content" id="education">
                        <div class="section-header">
                            <h2>Education Level <span class="required">*</span></h2>
                            <p>Select the highest education level achieved by the candidate</p>
                        </div>
                        <div class="education-cards" id="educationContainer">
                            <!-- Education options will be dynamically added here -->
                        </div>
                        <div class="error-message" id="educationError">Please select an education level.</div>
                    </div>

                    <!-- Skills Tab Content -->
                    <div class="tab-content" id="skills">
                        <div class="section-header">
                            <h2>Required Skills and Proficiency Levels <span class="required">*</span></h2>
                            <p>Select one proficiency level for each skill</p>
                        </div>
                        <div class="skill-cards" id="skillsContainer">
                            <!-- Skills will be dynamically added here -->
                        </div>
                        <div class="error-message" id="skillsError">Please select a proficiency level for all skills.</div>
                    </div>

                    <!-- Technical Tab Content -->
                    <div class="tab-content" id="technical">
                        <div class="section-header">
                            <h2>Technical Knowledge and Proficiency Levels <span class="required">*</span></h2>
                            <p>Select one proficiency level for each technical skill</p>
                        </div>
                        <div class="skill-cards" id="technicalContainer">
                            <!-- Technical skills will be dynamically added here -->
                        </div>
                        <div class="error-message" id="technicalError">Please select a proficiency level for all technical skills.</div>
                    </div>

                    <!-- Industry Tab Content -->
                    <div class="tab-content" id="industry">
                        <div class="section-header">
                            <h2>Industry & Niche Experience <span class="required">*</span></h2>
                            <p>Check all industries and niches that the candidate has experience in</p>
                        </div>
                        <div class="industry-cards" id="industryContainer">
                            <!-- Industry options will be dynamically added here -->
                        </div>
                        <div class="error-message" id="industryError">Please select at least one industry.</div>
                    </div>

                    <!-- Experience Tab Content -->
                    <div class="tab-content" id="experience">
                        <div class="section-header">
                            <h2>Years of Experience <span class="required">*</span></h2>
                            <p>Select the candidate's total relevant work experience</p>
                        </div>
                        <div class="experience-cards" id="experienceContainer">
                            <!-- Experience options will be dynamically added here -->
                        </div>
                        <div class="error-message" id="experienceError">Please select an experience level.</div>
                    </div>
                </form>
            </div>
            <div class="card-footer">
                <button class="btn-outline" id="prevBtn" disabled>Previous</button>
                <button class="btn-primary" id="nextBtn">Next</button>
                <button class="btn-primary hidden" id="submitBtn">Submit</button>
            </div>
        </div>

        <!-- Loading Card -->
        <div class="card hidden" id="loadingCard">
            <div class="loading">
                <div class="spinner"></div>
                <p>Calculating results...</p>
            </div>
        </div>

        <!-- Results Card -->
        <div class="card hidden" id="resultsCard">
            <div class="card-header">
                <h1 class="card-title">Assessment Results</h1>
                <p class="card-description">Based on the assessment, here are the best role matches</p>
            </div>
            <div class="card-content" id="resultsContainer">
                <!-- Results will be dynamically added here -->
            </div>
            <div class="card-footer">
                <button class="btn-outline" id="newAssessmentBtn">Start New Assessment</button>
            </div>
        </div>
    </div>

    <script>
        // Google Apps Script Web App URL - REPLACE THIS WITH YOUR DEPLOYED WEB APP URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/a/macros/callboxinc.com/s/AKfycbzFJp9FSEoTNBtegizxm6l9q_8tUi5HtdymB87uzH4_BhmxsWg2XspEZnBB4fZ714bH2A/exec';

        // Form data
        const skillsData = {
            "Sales": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Client Management": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Email Skills": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Data Profiling": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Data Analytics": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Digital Marketing": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "QA & Coaching": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Training": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Writing": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "UI/UX": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Multimedia": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Data Research": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Social Media": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Editing": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Production Editing": ["Beginner", "Intermediate", "Advanced", "Expert"]
        };

        const technicalData = {
            "CRM": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Google Analytics": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Social Media Management Platforms": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Marketing Automation Tools": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Training Tools": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "SQL / Data Visualization Tools": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "UI/UX Design Tools": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Adobe Creative Suite": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "SEO & Content Marketing Tools": ["Beginner", "Intermediate", "Advanced", "Expert"],
            "Sales Automation Tools": ["Beginner", "Intermediate", "Advanced", "Expert"]
        };

        const industryData = [
            "B2B Sales & Lead Generation",
            "Customer Success / Client Management",
            "Data & Analytics",
            "Digital Marketing & Content Creation",
            "E-commerce",
            "UI/UX & Product Design"
        ];

        // Education data with point values - Updated "Some College" to 0.5 points
        const educationData = [
            { level: "Some College", points: 0.5 },
            { level: "Bachelor's Degree", points: 1 },
            { level: "Master's Degree", points: 2 }
        ];

        // Years of experience options with point values
        const experienceData = [
            { level: "Less than 1 year", points: 0.5 },
            { level: "1-3 years", points: 1 },
            { level: "3-5 years", points: 1.5 },
            { level: "5-10 years", points: 2 },
            { level: "10+ years", points: 3 }
        ];

        // Role descriptions for results page
        const roleDescriptions = {
            "Sales QA/Coach": "Responsible for quality assurance and coaching in sales processes, focusing on performance improvement and training.",
            "Mid-Level Junior Client Service / BDM (Sales)": "Manages client relationships and sales processes, focusing on account management and business development.",
            "Content Writer": "Creates engaging written content for various platforms, focusing on SEO and marketing materials.",
            "Social Media Marketer": "Manages social media presence and campaigns, focusing on engagement and brand awareness.",
            "Email Marketing Specialist": "Develops and executes email marketing campaigns, focusing on lead nurturing and conversion.",
            "Data Researcher": "Conducts data collection and research, focusing on lead sourcing and market insights.",
            "Data Profiler": "Verifies and cleanses data, focusing on data integrity and enrichment.",
            "Data Analyst": "Analyzes data to provide insights, focusing on trends and performance metrics.",
            "Digital Marketing Strategist": "Develops marketing strategies across digital channels, focusing on campaign performance and ROI.",
            "Junior Business Development Representative": "Generates leads and initiates sales processes, focusing on outbound prospecting.",
            "Senior Sales Tech": "Provides technical sales support, focusing on product knowledge and demonstrations.",
            "Callbox Social Media Manager": "Manages social media strategy and execution, focusing on brand presence and community engagement.",
            "UI/UX Designer (CRM Focus)": "Designs user interfaces and experiences, focusing on CRM systems and user-centered design.",
            "Senior Business Development": "Leads business development initiatives, focusing on enterprise sales and strategic partnerships.",
            "Senior Client Success Manager (Operations Manager)": "Manages client relationships and team operations, focusing on retention and satisfaction.",
            "Senior Sales Development Representative": "Leads sales development efforts, focusing on pipeline generation and qualification.",
            "Production Specialist (SDR Trainer)": "Coordinates production processes and training, focusing on efficiency and quality."
        };

        // Role data for matching
        const roleData = {
            "Sales QA/Coach": {
                skills: {
                    "QA & Coaching": "Expert",
                    "Training": "Expert",
                    "Data Analytics": "Advanced",
                    "Digital Marketing": "Advanced",
                    "Sales": "Intermediate",
                    "Client Management": "Intermediate",
                    "Email Skills": "Intermediate",
                    "Data Profiling": "Intermediate",
                    "UI/UX": "Beginner",
                    "Production Editing": "Beginner",
                    "Writing": "Beginner",
                    "Social Media": "Beginner"
                },
                technical: {
                    "Training Tools": "Expert",
                    "SQL / Data Visualization Tools": "Expert",
                    "CRM": "Intermediate",
                    "Google Analytics": "Intermediate",
                    "Social Media Management Platforms": "Intermediate",
                    "Marketing Automation Tools": "Intermediate",
                    "Adobe Creative Suite": "Beginner",
                    "SEO & Content Marketing Tools": "Beginner"
                },
                industry: ["B2B Sales & Lead Generation", "Customer Success / Client Management", "Data & Analytics"]
            },
            "Mid-Level Junior Client Service / BDM (Sales)": {
                skills: {
                    "QA & Coaching": "Expert",
                    "Sales": "Advanced",
                    "Client Management": "Advanced",
                    "Training": "Advanced",
                    "Data Research": "Intermediate",
                    "Email Skills": "Intermediate",
                    "Digital Marketing": "Intermediate",
                    "Writing": "Beginner",
                    "UI/UX": "Beginner",
                    "Multimedia": "Beginner"
                },
                technical: {
                    "CRM": "Expert",
                    "Marketing Automation Tools": "Expert",
                    "Social Media Management Platforms": "Expert",
                    "Google Analytics": "Intermediate",
                    "SEO & Content Marketing Tools": "Intermediate",
                    "SQL / Data Visualization Tools": "Intermediate",
                    "UI/UX Design Tools": "Beginner",
                    "Adobe Creative Suite": "Beginner"
                },
                industry: ["B2B Sales & Lead Generation", "Customer Success / Client Management", "Digital Marketing & Content Creation"]
            },
            "Content Writer": {
                skills: {
                    "Writing": "Advanced",
                    "Editing": "Advanced",
                    "Multimedia": "Advanced",
                    "Social Media": "Intermediate",
                    "Email Skills": "Intermediate",
                    "Digital Marketing": "Intermediate",
                    "Sales": "Beginner",
                    "Client Management": "Beginner",
                    "Training": "Beginner"
                },
                technical: {
                    "SEO & Content Marketing Tools": "Expert",
                    "Adobe Creative Suite": "Expert",
                    "Google Analytics": "Intermediate",
                    "Social Media Management Platforms": "Intermediate",
                    "Marketing Automation Tools": "Intermediate",
                    "CRM": "Beginner",
                    "UI/UX Design Tools": "Beginner",
                    "SQL / Data Visualization Tools": "Beginner"
                },
                industry: ["Digital Marketing & Content Creation", "B2B Sales & Lead Generation", "E-commerce"]
            },
            "Social Media Marketer": {
                skills: {
                    "Social Media": "Expert",
                    "Digital Marketing": "Advanced",
                    "Writing": "Advanced",
                    "Multimedia": "Advanced",
                    "Email Skills": "Intermediate",
                    "Editing": "Intermediate",
                    "Client Management": "Intermediate",
                    "Sales": "Beginner",
                    "Data Analytics": "Beginner"
                },
                technical: {
                    "Social Media Management Platforms": "Expert",
                    "SEO & Content Marketing Tools": "Advanced",
                    "Google Analytics": "Advanced",
                    "Adobe Creative Suite": "Intermediate",
                    "Marketing Automation Tools": "Intermediate",
                    "CRM": "Beginner",
                    "UI/UX Design Tools": "Beginner"
                },
                industry: ["Digital Marketing & Content Creation", "E-commerce", "B2B Sales & Lead Generation"]
            },
            "Email Marketing Specialist": {
                skills: {
                    "Email Skills": "Expert",
                    "Digital Marketing": "Advanced",
                    "Writing": "Advanced",
                    "Editing": "Advanced",
                    "Data Analytics": "Intermediate",
                    "Social Media": "Intermediate",
                    "Client Management": "Intermediate",
                    "Sales": "Beginner"
                },
                technical: {
                    "Marketing Automation Tools": "Expert",
                    "CRM": "Advanced",
                    "Google Analytics": "Advanced",
                    "SEO & Content Marketing Tools": "Intermediate",
                    "Social Media Management Platforms": "Intermediate",
                    "Adobe Creative Suite": "Beginner"
                },
                industry: ["Digital Marketing & Content Creation", "B2B Sales & Lead Generation", "E-commerce"]
            },
            "Data Researcher": {
                skills: {
                    "Data Research": "Expert",
                    "Data Profiling": "Advanced",
                    "Data Analytics": "Intermediate",
                    "Writing": "Intermediate",
                    "Email Skills": "Intermediate",
                    "Digital Marketing": "Beginner",
                    "Social Media": "Beginner"
                },
                technical: {
                    "SQL / Data Visualization Tools": "Advanced",
                    "Google Analytics": "Advanced",
                    "CRM": "Intermediate",
                    "Marketing Automation Tools": "Beginner",
                    "SEO & Content Marketing Tools": "Beginner"
                },
                industry: ["Data & Analytics", "B2B Sales & Lead Generation", "Digital Marketing & Content Creation"]
            },
            "Data Profiler": {
                skills: {
                    "Data Profiling": "Expert",
                    "Data Research": "Advanced",
                    "Data Analytics": "Intermediate",
                    "Email Skills": "Intermediate",
                    "Digital Marketing": "Beginner",
                    "Sales": "Beginner"
                },
                technical: {
                    "SQL / Data Visualization Tools": "Advanced",
                    "CRM": "Advanced",
                    "Google Analytics": "Intermediate",
                    "Marketing Automation Tools": "Beginner"
                },
                industry: ["Data & Analytics", "B2B Sales & Lead Generation"]
            },
            "Data Analyst": {
                skills: {
                    "Data Analytics": "Expert",
                    "Data Profiling": "Advanced",
                    "Data Research": "Advanced",
                    "Digital Marketing": "Intermediate",
                    "Email Skills": "Intermediate",
                    "Writing": "Beginner",
                    "Social Media": "Beginner"
                },
                technical: {
                    "SQL / Data Visualization Tools": "Expert",
                    "Google Analytics": "Expert",
                    "CRM": "Intermediate",
                    "Marketing Automation Tools": "Intermediate",
                    "Social Media Management Platforms": "Beginner"
                },
                industry: ["Data & Analytics", "Digital Marketing & Content Creation", "B2B Sales & Lead Generation"]
            },
            "Digital Marketing Strategist": {
                skills: {
                    "Digital Marketing": "Expert",
                    "Social Media": "Advanced",
                    "Email Skills": "Advanced",
                    "Writing": "Advanced",
                    "Data Analytics": "Advanced",
                    "Client Management": "Intermediate",
                    "Sales": "Intermediate",
                    "Multimedia": "Intermediate",
                    "Editing": "Intermediate"
                },
                technical: {
                    "Google Analytics": "Expert",
                    "SEO & Content Marketing Tools": "Expert",
                    "Social Media Management Platforms": "Advanced",
                    "Marketing Automation Tools": "Advanced",
                    "CRM": "Intermediate",
                    "Adobe Creative Suite": "Intermediate"
                },
                industry: ["Digital Marketing & Content Creation", "B2B Sales & Lead Generation", "E-commerce"]
            },
            "Junior Business Development Representative": {
                skills: {
                    "Sales": "Intermediate",
                    "Client Management": "Intermediate",
                    "Email Skills": "Intermediate",
                    "Digital Marketing": "Beginner",
                    "Data Research": "Beginner",
                    "Social Media": "Beginner"
                },
                technical: {
                    "CRM": "Intermediate",
                    "Sales Automation Tools": "Intermediate",
                    "Marketing Automation Tools": "Beginner",
                    "Social Media Management Platforms": "Beginner"
                },
                industry: ["B2B Sales & Lead Generation", "Customer Success / Client Management"]
            },
            "Senior Sales Tech": {
                skills: {
                    "Sales": "Expert",
                    "Client Management": "Advanced",
                    "Training": "Advanced",
                    "QA & Coaching": "Advanced",
                    "Email Skills": "Advanced",
                    "Digital Marketing": "Intermediate",
                    "Data Analytics": "Intermediate"
                },
                technical: {
                    "CRM": "Expert",
                    "Sales Automation Tools": "Expert",
                    "Marketing Automation Tools": "Advanced",
                    "Google Analytics": "Intermediate",
                    "Social Media Management Platforms": "Intermediate",
                    "Training Tools": "Intermediate"
                },
                industry: ["B2B Sales & Lead Generation", "Customer Success / Client Management", "Digital Marketing & Content Creation"]
            },
            "Callbox Social Media Manager": {
                skills: {
                    "Social Media": "Expert",
                    "Digital Marketing": "Expert",
                    "Writing": "Advanced",
                    "Multimedia": "Advanced",
                    "Client Management": "Advanced",
                    "Email Skills": "Intermediate",
                    "Data Analytics": "Intermediate",
                    "Editing": "Intermediate"
                },
                technical: {
                    "Social Media Management Platforms": "Expert",
                    "SEO & Content Marketing Tools": "Expert",
                    "Google Analytics": "Advanced",
                    "Adobe Creative Suite": "Advanced",
                    "CRM": "Intermediate",
                    "Marketing Automation Tools": "Intermediate"
                },
                industry: ["Digital Marketing & Content Creation", "B2B Sales & Lead Generation", "E-commerce"]
            },
            "UI/UX Designer (CRM Focus)": {
                skills: {
                    "UI/UX": "Expert",
                    "Multimedia": "Advanced",
                    "Digital Marketing": "Intermediate",
                    "Client Management": "Intermediate",
                    "Data Analytics": "Beginner",
                    "Writing": "Beginner"
                },
                technical: {
                    "UI/UX Design Tools": "Expert",
                    "Adobe Creative Suite": "Expert",
                    "CRM": "Advanced",
                    "Google Analytics": "Intermediate",
                    "Social Media Management Platforms": "Beginner"
                },
                industry: ["UI/UX & Product Design", "Digital Marketing & Content Creation", "Customer Success / Client Management"]
            },
            "Senior Business Development": {
                skills: {
                    "Sales": "Expert",
                    "Client Management": "Expert",
                    "Email Skills": "Advanced",
                    "Digital Marketing": "Advanced",
                    "Training": "Advanced",
                    "QA & Coaching": "Advanced",
                    "Data Analytics": "Intermediate",
                    "Social Media": "Intermediate"
                },
                technical: {
                    "CRM": "Expert",
                    "Sales Automation Tools": "Expert",
                    "Marketing Automation Tools": "Advanced",
                    "Google Analytics": "Advanced",
                    "Social Media Management Platforms": "Intermediate",
                    "SEO & Content Marketing Tools": "Intermediate"
                },
                industry: ["B2B Sales & Lead Generation", "Customer Success / Client Management", "Digital Marketing & Content Creation"]
            },
            "Senior Client Success Manager (Operations Manager)": {
                skills: {
                    "Client Management": "Expert",
                    "QA & Coaching": "Expert",
                    "Training": "Expert",
                    "Sales": "Advanced",
                    "Email Skills": "Advanced",
                    "Digital Marketing": "Intermediate",
                    "Data Analytics": "Intermediate",
                    "Social Media": "Intermediate"
                },
                technical: {
                    "CRM": "Expert",
                    "Training Tools": "Expert",
                    "Sales Automation Tools": "Advanced",
                    "Marketing Automation Tools": "Advanced",
                    "Google Analytics": "Intermediate",
                    "Social Media Management Platforms": "Intermediate"
                },
                industry: ["Customer Success / Client Management", "B2B Sales & Lead Generation", "Digital Marketing & Content Creation"]
            },
            "Senior Sales Development Representative": {
                skills: {
                    "Sales": "Expert",
                    "Client Management": "Advanced",
                    "Email Skills": "Advanced",
                    "Digital Marketing": "Advanced",
                    "Data Research": "Intermediate",
                    "Social Media": "Intermediate",
                    "Training": "Intermediate",
                    "QA & Coaching": "Intermediate"
                },
                technical: {
                    "CRM": "Expert",
                    "Sales Automation Tools": "Expert",
                    "Marketing Automation Tools": "Advanced",
                    "Social Media Management Platforms": "Intermediate",
                    "Google Analytics": "Intermediate",
                    "SEO & Content Marketing Tools": "Beginner"
                },
                industry: ["B2B Sales & Lead Generation", "Customer Success / Client Management", "Digital Marketing & Content Creation"]
            },
            "Production Specialist (SDR Trainer)": {
                skills: {
                    "Training": "Expert",
                    "QA & Coaching": "Expert",
                    "Production Editing": "Advanced",
                    "Sales": "Advanced",
                    "Client Management": "Advanced",
                    "Email Skills": "Advanced",
                    "Digital Marketing": "Intermediate",
                    "Data Analytics": "Intermediate"
                },
                technical: {
                    "Training Tools": "Expert",
                    "CRM": "Expert",
                    "Sales Automation Tools": "Advanced",
                    "Marketing Automation Tools": "Advanced",
                    "Google Analytics": "Intermediate",
                    "Social Media Management Platforms": "Intermediate"
                },
                industry: ["B2B Sales & Lead Generation", "Customer Success / Client Management", "Digital Marketing & Content Creation"]
            }
        };

        // DOM Elements
        const homeCard = document.getElementById('homeCard');
        const assessmentCard = document.getElementById('assessmentCard');
        const loadingCard = document.getElementById('loadingCard');
        const resultsCard = document.getElementById('resultsCard');
        const startAssessmentBtn = document.getElementById('startAssessmentBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        const newAssessmentBtn = document.getElementById('newAssessmentBtn');
        const skillsContainer = document.getElementById('skillsContainer');
        const technicalContainer = document.getElementById('technicalContainer');
        const industryContainer = document.getElementById('industryContainer');
        const educationContainer = document.getElementById('educationContainer');
        const experienceContainer = document.getElementById('experienceContainer');
        const resultsContainer = document.getElementById('resultsContainer');
        const tabs = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');

        // Current tab index
        let currentTabIndex = 0;
        const tabIds = ['applicant', 'education', 'skills', 'technical', 'industry', 'experience'];

        // Initialize the app
        function init() {
            // Populate skills, technical, industry, education, and experience sections
            populateSkills();
            populateTechnical();
            populateIndustry();
            populateEducation();
            populateExperience();

            // Set up event listeners
            startAssessmentBtn.addEventListener('click', startAssessment);
            prevBtn.addEventListener('click', goToPreviousTab);
            nextBtn.addEventListener('click', goToNextTab);
            submitBtn.addEventListener('click', submitAssessment);
            newAssessmentBtn.addEventListener('click', startNewAssessment);

            // Set up tab click handlers
            tabs.forEach((tab, index) => {
                tab.addEventListener('click', () => showTab(index));
            });
        }

        // Populate skills section
        function populateSkills() {
            skillsContainer.innerHTML = '';
            
            Object.entries(skillsData).forEach(([skill, levels]) => {
                const skillCard = document.createElement('div');
                skillCard.className = 'skill-card';
                
                const skillTitle = document.createElement('h3');
                skillTitle.textContent = skill;
                
                const radioGroup = document.createElement('div');
                radioGroup.className = 'radio-group';
                
                levels.forEach(level => {
                    const radioOption = document.createElement('div');
                    radioOption.className = 'radio-option';
                    
                    const input = document.createElement('input');
                    input.type = 'radio';
                    input.id = `skill-${skill}-${level}`;
                    input.name = `skill-${skill}`;
                    input.value = level;
                    input.required = true;
                    
                    const label = document.createElement('label');
                    label.htmlFor = `skill-${skill}-${level}`;
                    label.textContent = level;
                    label.className = level.toLowerCase();
                    
                    radioOption.appendChild(input);
                    radioOption.appendChild(label);
                    radioGroup.appendChild(radioOption);
                });
                
                skillCard.appendChild(skillTitle);
                skillCard.appendChild(radioGroup);
                skillsContainer.appendChild(skillCard);
            });
        }

        // Populate technical section
        function populateTechnical() {
            technicalContainer.innerHTML = '';
            
            Object.entries(technicalData).forEach(([tech, levels]) => {
                const techCard = document.createElement('div');
                techCard.className = 'skill-card';
                
                const techTitle = document.createElement('h3');
                techTitle.textContent = tech;
                
                const radioGroup = document.createElement('div');
                radioGroup.className = 'radio-group';
                
                levels.forEach(level => {
                    const radioOption = document.createElement('div');
                    radioOption.className = 'radio-option';
                    
                    const input = document.createElement('input');
                    input.type = 'radio';
                    input.id = `tech-${tech}-${level}`;
                    input.name = `tech-${tech}`;
                    input.value = level;
                    input.required = true;
                    
                    const label = document.createElement('label');
                    label.htmlFor = `tech-${tech}-${level}`;
                    label.textContent = level;
                    label.className = level.toLowerCase();
                    
                    radioOption.appendChild(input);
                    radioOption.appendChild(label);
                    radioGroup.appendChild(radioOption);
                });
                
                techCard.appendChild(techTitle);
                techCard.appendChild(radioGroup);
                technicalContainer.appendChild(techCard);
            });
        }

        // Populate industry section
        function populateIndustry() {
            industryContainer.innerHTML = '';
            
            industryData.forEach(industry => {
                const industryCard = document.createElement('div');
                industryCard.className = 'industry-card';
                
                const input = document.createElement('input');
                input.type = 'checkbox';
                input.id = `industry-${industry}`;
                input.name = `industry-${industry}`;
                input.value = 'true';
                
                const label = document.createElement('label');
                label.htmlFor = `industry-${industry}`;
                label.textContent = industry;
                
                industryCard.appendChild(input);
                industryCard.appendChild(label);
                industryContainer.appendChild(industryCard);
            });
        }

        // Populate education section
        function populateEducation() {
            educationContainer.innerHTML = '';
            
            educationData.forEach(education => {
                const educationCard = document.createElement('div');
                educationCard.className = 'education-card';
                
                const input = document.createElement('input');
                input.type = 'radio';
                input.id = `education-${education.level}`;
                input.name = 'education';
                input.value = education.level;
                input.required = true;
                
                const label = document.createElement('label');
                label.htmlFor = `education-${education.level}`;
                label.textContent = education.level;
                
                educationCard.appendChild(input);
                educationCard.appendChild(label);
                educationContainer.appendChild(educationCard);
            });
        }

        // Populate experience section
        function populateExperience() {
            experienceContainer.innerHTML = '';
            
            experienceData.forEach(experience => {
                const experienceCard = document.createElement('div');
                experienceCard.className = 'experience-card';
                
                const input = document.createElement('input');
                input.type = 'radio';
                input.id = `experience-${experience.level}`;
                input.name = 'experience';
                input.value = experience.level;
                input.required = true;
                
                const label = document.createElement('label');
                label.htmlFor = `experience-${experience.level}`;
                label.textContent = experience.level;
                
                experienceCard.appendChild(input);
                experienceCard.appendChild(label);
                experienceContainer.appendChild(experienceCard);
            });
        }

        // Start assessment
        function startAssessment() {
            homeCard.classList.add('hidden');
            assessmentCard.classList.remove('hidden');
            showTab(0);
        }

        // Show tab
        function showTab(index) {
            tabContents.forEach(content => content.classList.remove('active'));
            tabs.forEach(tab => tab.classList.remove('active'));
            
            tabContents[index].classList.add('active');
            tabs[index].classList.add('active');
            
            // Update navigation buttons
            prevBtn.disabled = index === 0;
            
            if (index === tabIds.length - 1) {
                nextBtn.classList.add('hidden');
                submitBtn.classList.remove('hidden');
            } else {
                nextBtn.classList.remove('hidden');
                submitBtn.classList.add('hidden');
            }
            
            currentTabIndex = index;
            
            // Hide all error messages when switching tabs
            document.querySelectorAll('.error-message').forEach(el => {
                el.style.display = 'none';
            });
        }

        // Go to previous tab
        function goToPreviousTab() {
            if (currentTabIndex > 0) {
                showTab(currentTabIndex - 1);
            }
        }

        // Go to next tab
        function goToNextTab() {
            if (validateCurrentTab()) {
                if (currentTabIndex < tabIds.length - 1) {
                    showTab(currentTabIndex + 1);
                }
            }
        }

        // Validate current tab
        function validateCurrentTab() {
            const currentTabId = tabIds[currentTabIndex];
            const errorElement = document.getElementById(`${currentTabId}Error`);
            
            // Hide error message initially
            if (errorElement) {
                errorElement.style.display = 'none';
            }
            
            switch (currentTabId) {
                case 'applicant':
                    // Validate applicant info
                    const name = document.getElementById('name').value;
                    const email = document.getElementById('email').value;
                    
                    if (!name || !email) {
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                        return false;
                    }
                    return true;
                    
                case 'education':
                    // Validate education selection
                    const educationSelected = document.querySelector('input[name="education"]:checked');
                    if (!educationSelected) {
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                        return false;
                    }
                    return true;
                    
                case 'skills':
                    // Validate all skills have a selection
                    let allSkillsSelected = true;
                    Object.keys(skillsData).forEach(skill => {
                        const skillSelected = document.querySelector(`input[name="skill-${skill}"]:checked`);
                        if (!skillSelected) {
                            allSkillsSelected = false;
                        }
                    });
                    
                    if (!allSkillsSelected) {
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                        return false;
                    }
                    return true;
                    
                case 'technical':
                    // Validate all technical skills have a selection
                    let allTechnicalSelected = true;
                    Object.keys(technicalData).forEach(tech => {
                        const techSelected = document.querySelector(`input[name="tech-${tech}"]:checked`);
                        if (!techSelected) {
                            allTechnicalSelected = false;
                        }
                    });
                    
                    if (!allTechnicalSelected) {
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                        return false;
                    }
                    return true;
                    
                case 'industry':
                    // Validate at least one industry is selected
                    const industrySelected = document.querySelector('input[type="checkbox"][name^="industry-"]:checked');
                    if (!industrySelected) {
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                        return false;
                    }
                    return true;
                    
                case 'experience':
                    // Validate experience selection
                    const experienceSelected = document.querySelector('input[name="experience"]:checked');
                    if (!experienceSelected) {
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                        return false;
                    }
                    return true;
                    
                default:
                    return true;
            }
        }

        // Submit assessment
        function submitAssessment() {
            if (validateCurrentTab()) {
                // Show loading card
                assessmentCard.classList.add('hidden');
                loadingCard.classList.remove('hidden');
                
                // Collect form data
                const formData = new FormData(document.getElementById('assessmentForm'));
                const applicantData = {
                    name: formData.get('name'),
                    email: formData.get('email'),
                    phone: formData.get('phone') || '',
                    skills: {},
                    technical: {},
                    industry: {},
                    education: formData.get('education') || '',
                    experience: formData.get('experience') || ''
                };
                
                // Process skills
                Object.keys(skillsData).forEach(skill => {
                    const value = formData.get(`skill-${skill}`);
                    if (value) {
                        applicantData.skills[skill] = value;
                    }
                });
                
                // Process technical
                Object.keys(technicalData).forEach(tech => {
                    const value = formData.get(`tech-${tech}`);
                    if (value) {
                        applicantData.technical[tech] = value;
                    }
                });
                
                // Process industry
                industryData.forEach(industry => {
                    if (formData.get(`industry-${industry}`)) {
                        applicantData.industry[industry] = true;
                    }
                });
                
                // Calculate matches
                const matches = calculateRoleMatches(applicantData);
                
                // Prepare data for Google Sheets
                const data = {
                    applicant: applicantData,
                    results: {
                        bestMatch: matches[0] || {},
                        secondMatch: matches[1] || {},
                        thirdMatch: matches[2] || {}
                    },
                    timestamp: new Date().toISOString()
                };
                
                // Save to Google Sheets
                saveToGoogleSheets(data);
                
                // Display results
                displayResults(matches);
                
                // Hide loading card, show results card
                setTimeout(() => {
                    loadingCard.classList.add('hidden');
                    resultsCard.classList.remove('hidden');
                }, 1500);
            }
        }

        // Save data to Google Sheets
        function saveToGoogleSheets(data) {
            // Method 1: Using iframe to submit data (more reliable for cross-domain)
            const jsonData = encodeURIComponent(JSON.stringify(data));
            const url = `${GOOGLE_SCRIPT_URL}?data=${jsonData}`;
            
            // Create a hidden iframe to submit the data
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            document.body.appendChild(iframe);
            
            // Set up message listener for completion
            window.addEventListener('message', function(event) {
                if (event.data === 'success') {
                    console.log('Data saved successfully via iframe');
                    document.body.removeChild(iframe);
                }
            }, false);
            
            // Navigate the iframe to the URL with data
            iframe.src = url;
            
            // Method 2: Fallback to fetch API if iframe doesn't work
            setTimeout(() => {
                // If we're still here after 5 seconds, try the fetch method as backup
                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: JSON.stringify(data),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => {
                    console.log('Response received from fetch method');
                    return response.text();
                })
                .then(text => {
                    console.log('Response text:', text);
                    console.log('Data likely saved successfully via fetch');
                })
                .catch(error => {
                    console.error('Error with fetch method:', error);
                });
            }, 5000);
        }

        // Calculate role matches
        function calculateRoleMatches(applicantData) {
            // Calculate score for each role
            const roleScores = Object.keys(roleData).map(role => {
                const roleInfo = roleData[role];
                let totalPoints = 0;
                let maxPoints = 0;

                // Calculate skills score
                Object.entries(applicantData.skills).forEach(([skill, level]) => {
                    // Check if this skill is required for the role
                    if (roleInfo.skills[skill]) {
                        const requiredLevel = roleInfo.skills[skill];

                        // Map level to numeric value for comparison
                        const levelValues = {
                            "Beginner": 1,
                            "Intermediate": 2,
                            "Advanced": 3,
                            "Expert": 4
                        };

                        const candidateLevel = levelValues[level];
                        const requiredLevelValue = levelValues[requiredLevel];

                        // Award points based on how close the candidate's level is to the required level
                        if (candidateLevel >= requiredLevelValue) {
                            totalPoints += 3; // Full points if meeting or exceeding required level
                        } else if (candidateLevel === requiredLevelValue - 1) {
                            totalPoints += 1; // Partial points if one level below
                        }

                        maxPoints += 3; // Maximum possible points for this skill
                    }
                });

                // Calculate technical knowledge score
                Object.entries(applicantData.technical).forEach(([tech, level]) => {
                    // Check if this technical knowledge is required for the role
                    if (roleInfo.technical[tech]) {
                        const requiredLevel = roleInfo.technical[tech];

                        // Map level to numeric value for comparison
                        const levelValues = {
                            "Beginner": 1,
                            "Intermediate": 2,
                            "Advanced": 3,
                            "Expert": 4
                        };

                        const candidateLevel = levelValues[level];
                        const requiredLevelValue = levelValues[requiredLevel];

                        // Award points based on how close the candidate's level is to the required level
                        if (candidateLevel >= requiredLevelValue) {
                            totalPoints += 2; // Full points if meeting or exceeding required level
                        } else if (candidateLevel === requiredLevelValue - 1) {
                            totalPoints += 1; // Partial points if one level below
                        }

                        maxPoints += 2; // Maximum possible points for this technical knowledge
                    }
                });

                // Calculate industry experience score
                Object.keys(applicantData.industry).forEach(ind => {
                    // Check if this industry experience is required for the role
                    if (roleInfo.industry.includes(ind)) {
                        totalPoints += 2;
                    }

                    maxPoints += 2; // Maximum possible points for this industry
                });

                // Calculate raw score as a percentage
                const rawScore = maxPoints > 0 ? (totalPoints / maxPoints) * 100 : 0;
                
                const result = {
                    role,
                    rawScore,
                    description: roleDescriptions[role] || "",
                    keySkills: Object.keys(roleInfo.skills).slice(0, 3),
                    techKnowledge: Object.keys(roleInfo.technical).slice(0, 3)
                };

                // Add education points if available
                if (applicantData.education) {
                    const educationInfo = educationData.find(edu => edu.level === applicantData.education);
                    if (educationInfo) {
                        result.rawScore += educationInfo.points;
                        result.educationPoints = educationInfo.points;
                    }
                }

                // Add experience points if available
                if (applicantData.experience) {
                    const experienceInfo = experienceData.find(exp => exp.level === applicantData.experience);
                    if (experienceInfo) {
                        result.rawScore += experienceInfo.points;
                        result.experiencePoints = experienceInfo.points;
                    }
                }

                return result;
            });

            // Sort roles by score (highest first)
            const sortedRoles = roleScores.sort((a, b) => b.rawScore - a.rawScore);

            // Get top 3 roles
            const top3Matches = sortedRoles.slice(0, 3);
            
            // Calculate the sum of the top 3 raw scores
            const totalRawScore = top3Matches.reduce((sum, match) => sum + match.rawScore, 0);
            
            // Normalize scores to make them add up to 100  => sum + match.rawScore, 0);
            
            // Normalize scores to make them add up to 100%
            if (totalRawScore > 0) {
                top3Matches.forEach(match => {
                    match.normalizedScore = Math.round((match.rawScore / totalRawScore) * 100);
                });
            } else {
                // If all scores are 0, distribute evenly
                top3Matches.forEach(match => {
                    match.normalizedScore = Math.round(100 / top3Matches.length);
                });
            }

            return top3Matches;
        }

        // Display results
        function displayResults(matches) {
            resultsContainer.innerHTML = '';
            
            matches.forEach((match, index) => {
                const resultCard = document.createElement('div');
                resultCard.className = 'result-card';
                
                const resultHeader = document.createElement('div');
                resultHeader.className = 'result-header';
                
                const resultTitle = document.createElement('div');
                resultTitle.className = 'result-title';
                resultTitle.textContent = index === 0 ? 'Best Match' : index === 1 ? '2nd Best Match' : '3rd Best Match';
                
                const matchPercentage = document.createElement('div');
                matchPercentage.className = 'match-percentage';
                matchPercentage.textContent = `${match.normalizedScore}% Match`;
                
                resultHeader.appendChild(resultTitle);
                resultHeader.appendChild(matchPercentage);
                
                // Add bonus points display
                if (match.educationPoints || match.experiencePoints) {
                    const bonusPoints = document.createElement('div');
                    bonusPoints.className = 'bonus-points';
                    
                    if (match.educationPoints) {
                        const educationSpan = document.createElement('span');
                        educationSpan.textContent = `+${match.educationPoints} pts from education`;
                        educationSpan.className = 'highlight';
                        bonusPoints.appendChild(educationSpan);
                    }
                    
                    if (match.experiencePoints) {
                        if (match.educationPoints) {
                            bonusPoints.appendChild(document.createTextNode(' '));
                        }
                        const experienceSpan = document.createElement('span');
                        experienceSpan.textContent = `+${match.experiencePoints} pts from experience`;
                        experienceSpan.className = 'highlight';
                        bonusPoints.appendChild(experienceSpan);
                    }
                    
                    resultHeader.appendChild(bonusPoints);
                }
                
                const roleName = document.createElement('div');
                roleName.className = 'role-name';
                roleName.textContent = match.role;
                
                const roleDescription = document.createElement('div');
                roleDescription.className = 'role-description';
                roleDescription.textContent = match.description;
                
                const skillsGrid = document.createElement('div');
                skillsGrid.className = 'skills-grid';
                
                // Key Skills section
                const keySkillsSection = document.createElement('div');
                keySkillsSection.className = 'skills-section';
                
                const keySkillsTitle = document.createElement('h4');
                keySkillsTitle.textContent = 'Key Skills';
                
                const keySkillsList = document.createElement('ul');
                keySkillsList.className = 'skills-list';
                
                match.keySkills.forEach(skill => {
                    const skillItem = document.createElement('li');
                    skillItem.textContent = skill;
                    keySkillsList.appendChild(skillItem);
                });
                
                keySkillsSection.appendChild(keySkillsTitle);
                keySkillsSection.appendChild(keySkillsList);
                
                // Technical Knowledge section
                const techSection = document.createElement('div');
                techSection.className = 'skills-section';
                
                const techTitle = document.createElement('h4');
                techTitle.textContent = 'Technical Knowledge';
                
                const techList = document.createElement('ul');
                techList.className = 'skills-list';
                
                match.techKnowledge.forEach(tech => {
                    const techItem = document.createElement('li');
                    techItem.textContent = tech;
                    techList.appendChild(techItem);
                });
                
                techSection.appendChild(techTitle);
                techSection.appendChild(techList);
                
                // Append all elements
                skillsGrid.appendChild(keySkillsSection);
                skillsGrid.appendChild(techSection);
                
                resultCard.appendChild(resultHeader);
                resultCard.appendChild(roleName);
                resultCard.appendChild(roleDescription);
                resultCard.appendChild(skillsGrid);
                
                resultsContainer.appendChild(resultCard);
            });
        }

        // Start new assessment
        function startNewAssessment() {
            document.getElementById('assessmentForm').reset();
            resultsCard.classList.add('hidden');
            assessmentCard.classList.remove('hidden');
            showTab(0);
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>